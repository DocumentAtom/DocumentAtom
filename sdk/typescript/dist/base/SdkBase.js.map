{"version":3,"file":"SdkBase.js","names":["_superagent","_interopRequireDefault","require","_SeverityEnum","_GenericExceptionHandlers","_Serializer","_Logger","e","__esModule","default","_defineProperty","r","t","_toPropertyKey","Object","defineProperty","value","enumerable","configurable","writable","i","_toPrimitive","Symbol","toPrimitive","call","TypeError","String","Number","SdkBase","constructor","config","GenericExceptionHandlers","ArgumentNullException","logger","Logger","log","sev","msg","upload","url","data","cancellationToken","Promise","resolve","reject","Error","request","superagent","post","set","defaultHeaders","send","timeout","response","timeoutMs","abort","SeverityEnum","Debug","method","then","res","status","Serializer","deserializeJson","text","catch","err","Warn","message","errorResponse","body","exports"],"sources":["../../src/base/SdkBase.ts"],"sourcesContent":["import superagent from 'superagent';\nimport { SeverityEnum } from '../enums/SeverityEnum';\nimport GenericExceptionHandlers from '../exception/GenericExceptionHandlers';\nimport Serializer from '../utils/Serializer';\nimport { SdkConfiguration } from './SdkConfiguration';\nimport Logger from '../utils/Logger';\n\n/**\n * SDK Base class for making API calls with logging and timeout functionality.\n * @module SdkBase\n */\nexport default class SdkBase {\n  private logger: (severity: SeverityEnum, message: string) => void;\n  protected config: SdkConfiguration;\n  /**\n   * Creates an instance of SdkBase.\n   * @param {SdkConfiguration} config - The SDK configuration.\n   * @throws {Error} Throws an error if the config is null.\n   */\n  constructor(config: SdkConfiguration) {\n    if (!config) {\n      GenericExceptionHandlers.ArgumentNullException('config');\n    }\n    this.config = config;\n    this.logger = Logger.log;\n  }\n\n  /**\n   * Logs a message with a severity level.\n   * @param {string} sev - The severity level (e.g., SeverityEnum.Debug, 'warn').\n   * @param {string} msg - The message to log.\n   */\n  protected log(sev: SeverityEnum, msg: string) {\n    if (!msg) return;\n    if (this.logger) this.logger(sev, msg);\n  }\n\n  /**\n   * Submits data using a POST request to a given URL.\n   * @param {string} url - The URL to post data to.\n   * @param {Buffer} data - The data to send in the POST request.\n   * @param {AbortController} [cancellationToken] - Optional cancellation token for cancelling the request.\n   * @return {Promise<Object>} Resolves with the response data.\n   * @throws {Error | ApiErrorResponse} Rejects if the URL or data is invalid or if the request fails.\n   */\n  protected upload<T>(url: string, data: Buffer | File, cancellationToken?: AbortController): Promise<T> {\n    return new Promise((resolve, reject) => {\n      if (!url) return reject(new Error('URL cannot be null or empty.'));\n      const request = superagent\n        .post(url)\n        .set(this.config.defaultHeaders)\n        .send(data)\n        .timeout({ response: this.config.timeoutMs });\n      // If a cancelToken is provided, attach the abort method\n      if (cancellationToken) {\n        cancellationToken.abort = () => {\n          request.abort();\n          this.log(SeverityEnum.Debug, `Request aborted to ${request.method}: ${url}.`);\n        };\n      }\n      request\n        .then((res) => {\n          this.log(SeverityEnum.Debug, `Success reported from ${request.method}: ${url}: ${res.status}`);\n          resolve(Serializer.deserializeJson(res.text || '{}'));\n        })\n        .catch((err) => {\n          this.log(SeverityEnum.Warn, `Failed to retrieve object from ${request.method}: ${url}: ${err.message}`);\n          const errorResponse = err?.response?.body || null;\n          if (errorResponse) {\n            reject(errorResponse);\n          } else {\n            reject(err.message ? err.message : err);\n          }\n        });\n    });\n  }\n}\n"],"mappings":"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","ignoreList":[]}